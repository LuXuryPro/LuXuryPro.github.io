<html>
<head>
    <!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">

<!-- jQuery library -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>

<!-- Latest compiled JavaScript -->
<script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
<script src="http://momentjs.com/downloads/moment-with-locales.min.js"></script>


<style>
img {
  width: 100%;
  height: 100%;
}
</style>

</head>
<body>

<h1 style="text-align: center;"id="intervaldiv"></h1>
<div class="progress">
  <div id="progress" class="progress-bar progress-bar-striped active" role="progressbar" aria-valuenow="0"
  aria-valuemin="0" aria-valuemax="100" style="width:0%">
    0%
  </div>
</div>

<h1 style="text-align: center;"id="lastDayOfWeek"></h1>

<div class="progress">
  <div id="progress_week" class="progress-bar progress-bar-striped active" role="progressbar" aria-valuenow="0"
  aria-valuemin="0" aria-valuemax="100" style="width:0%">
    0%
  </div>
</div>

<h1 style="text-align: center;"id="lastDayOfMonth"></h1>

<div class="progress">
  <div id="progress_day" class="progress-bar progress-bar-striped active" role="progressbar" aria-valuenow="0"
  aria-valuemin="0" aria-valuemax="100" style="width:0%">
    0%
  </div>
</div>

<script type="text/javascript">
function checkTime(i) {
    if (i < 10)
    {i = "0" + i};  // add zero in front of numbers < 10
    return i;
}


var lastFriday = function () {
  var lastDay = moment().endOf('month');
  if (lastDay.day() >= 5)
   var sub = lastDay.day() - 5;
  else
   var sub = lastDay.day() + 2;
  return lastDay.subtract(sub, 'days');
}



function get_end_time() {
    var e = new Date();
    e.setHours(16);
    e.setMinutes(0);
    e.setSeconds(0);
    return e
}

function get_diff() {
    var d = new Date();
    
    var diff = get_end_time() - d;
    if (diff < 0) {
        diff = 0;
    }
    return new Date(diff);
}

function get_start_time() {
    var s = new Date();
    s.setHours(8)
    s.setMinutes(0);
    s.setSeconds(0);
    return s;
}

function get_lenght() {
    return get_end_time() - get_start_time();
}

function get_procent() {
    var e = get_end_time();
    var d = new Date();
    if (d > e) {
        return 100;
    }
    var s = get_start_time();
    
    return (1 - (e-d)/(e-s)) * 100;
}

function update_time() {
    var diff = get_diff();
    var procent = get_procent();
    document.getElementById("intervaldiv").innerHTML = checkTime(diff.getUTCHours()) + ":"
    + checkTime(diff.getUTCMinutes()) + ":"
    + checkTime(diff.getUTCSeconds()) + " ("
    + procent.toFixed(2)+ "%)";
    var progress_bar = document.getElementById("progress");
    progress_bar.style.width=procent + "%";
    progress_bar.innerHTML = procent.toFixed(2) + "%";
}

function get_last_day_of_month() {
    return lastFriday();
}

function get_day_diff() {
    var diff = lastFriday().diff(moment())
    return new moment.duration(diff);
}

function get_day_diff_string() {
    var d = get_day_diff();
    return d.days() + " dni " + d.hours() + " godzin " + d.minutes() + " minut "
    + d.seconds() + " sekund ";
}

function get_day_procent() {
    var all_diff = moment.duration(lastFriday().diff(moment().startOf("month")));
    var diff = get_day_diff();
    return (1 - diff / all_diff) * 100;
}

function update_date() {
    document.getElementById("lastDayOfMonth").innerHTML = get_day_diff_string();
    var progress_bar = document.getElementById("progress_day");
    var procent = get_day_procent();
    progress_bar.style.width = procent + "%";
    progress_bar.innerHTML = procent.toFixed(2) + "%";
}

function get_next_freeday_diff() {
    var end = moment().day(5);
    end.hours(16);
    end.minutes(0);
    end.seconds(0);
    var diff = end.diff(moment());
    return moment.duration(diff);
}

function get_whole_week_diff() {
    var end = moment().day(5);
    end.hours(16);
    end.minutes(0);
    end.seconds(0);
    var diff = end.diff(moment().day(1));
    return moment.duration(diff);
}

function get_week_diff_string() {
    var d = get_next_freeday_diff();
    return d.days() + " dni " + d.hours() + " godzin " + d.minutes() + " minut "
    + d.seconds() + " sekund ";
}

function get_week_procent() {
    var all_diff = get_whole_week_diff();
    var diff = get_next_freeday_diff();
    return (1 - diff / all_diff) * 100;
}

function update_week() {
    document.getElementById("lastDayOfWeek").innerHTML = get_week_diff_string();
    var progress_bar = document.getElementById("progress_week");
    var procent = get_week_procent();
    progress_bar.style.width = procent + "%";
    progress_bar.innerHTML = procent.toFixed(2) + "%";
}

window.onload = function () {
    update_time();
    update_week();
    update_date();
    setInterval(update_time, 1000);
    setInterval(update_week, 1000);
    setInterval(update_date, 1000);
}

</script>
</body>
</html>
